{{ define "main" }}
{{/*{{- $publications := where $.Site.Data.cobiss "code" "in" (slice "1.01" "1.08") -}}*/}}
{{ $start := (now.AddDate -5 0 0).Format "2006" }}
{{ $publications := where $.Site.Data.cobiss ".year" "ge" $start }}

{{- $years := slice -}}
{{ range $publications }}
	{{ $years = $years | append .year }}
{{ end }}
{{ $years = uniq $years }}
{{ $years = sort $years "" "desc" }}

<main class="flex-fill container my-4" aria-role="main">
    <header>
        <h1>{{ .Title | title }}</h1>
    </header>

    <section>
        {{ .Content }}
    </section>

    <section>
        <ul class="list-group list-group-flush">
        {{ range $years }}
            {{ $year := . }}
            {{ with where $publications ".year" $year }}
            {{ $bib := . }}
            <li class="list-group-item">
                <h3>{{ $year }}</h3>
                <ul class="list-group list-group-flush">
                    {{ with where $bib ".code" "1.01" -}}
                    <li class="list-group-item">
                        <h4>Journals:</h4>
                        <ul class="list-group list-group-flush">
                        {{ range where . ".code" "1.01" }}
                            {{ partial "publication/li.html" . }}
                        {{ end }}
                        </ul>
                    </li>
                    {{ end }}
                    {{ with where $bib ".code" "1.08" -}}
                    <li class="list-group-item">
                        <h4>Conferences:</h4>
                        <ul class="list-group list-group-flush">
                        {{ range where . ".code" "1.08" }}
                            {{ partial "publication/li.html" . }}
                        {{ end }}
                        </ul>
                    </li>
                    {{ end }}
                </ul>
            </li>
            {{ end }}
        {{ end }}
        </ul>
    </section>

</main>
{{ end }}



